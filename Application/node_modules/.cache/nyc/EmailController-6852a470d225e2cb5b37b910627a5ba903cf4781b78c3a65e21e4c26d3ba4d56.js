function cov_25kmbsnw9z(){var path="/home/marcus/UNI/Year 3/COS 301/Capstone/Feature-Improvments/3D-model-Binary-Vision/Application/api/controller/EmailController.js";var hash="6d7460f230343959ea664fb25dbfddffa149c3e3";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/marcus/UNI/Year 3/COS 301/Capstone/Feature-Improvments/3D-model-Binary-Vision/Application/api/controller/EmailController.js",statementMap:{"0":{start:{line:5,column:17},end:{line:5,column:38}},"1":{start:{line:6,column:50},end:{line:6,column:82}},"2":{start:{line:9,column:18},end:{line:16,column:3}},"3":{start:{line:18,column:0},end:{line:70,column:1}},"4":{start:{line:26,column:24},end:{line:26,column:32}},"5":{start:{line:28,column:8},end:{line:52,column:11}},"6":{start:{line:29,column:12},end:{line:51,column:13}},"7":{start:{line:31,column:16},end:{line:31,column:44}},"8":{start:{line:32,column:16},end:{line:32,column:43}},"9":{start:{line:33,column:16},end:{line:33,column:23}},"10":{start:{line:37,column:16},end:{line:50,column:20}},"11":{start:{line:39,column:20},end:{line:49,column:22}},"12":{start:{line:41,column:25},end:{line:41,column:53}},"13":{start:{line:42,column:25},end:{line:42,column:52}},"14":{start:{line:43,column:25},end:{line:43,column:32}},"15":{start:{line:47,column:25},end:{line:47,column:56}},"16":{start:{line:48,column:25},end:{line:48,column:32}},"17":{start:{line:53,column:8},end:{line:53,column:15}},"18":{start:{line:62,column:8},end:{line:67,column:9}},"19":{start:{line:78,column:16},end:{line:78,column:30}},"20":{start:{line:79,column:17},end:{line:79,column:45}},"21":{start:{line:80,column:13},end:{line:80,column:23}},"22":{start:{line:82,column:4},end:{line:88,column:7}},"23":{start:{line:84,column:8},end:{line:86,column:9}},"24":{start:{line:85,column:12},end:{line:85,column:29}},"25":{start:{line:92,column:4},end:{line:97,column:5}},"26":{start:{line:100,column:17},end:{line:100,column:86}},"27":{start:{line:101,column:4},end:{line:101,column:99}},"28":{start:{line:102,column:4},end:{line:102,column:102}},"29":{start:{line:104,column:4},end:{line:110,column:7}},"30":{start:{line:106,column:8},end:{line:109,column:9}},"31":{start:{line:108,column:12},end:{line:108,column:31}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:23,column:25},end:{line:23,column:26}},loc:{start:{line:24,column:4},end:{line:54,column:5}},line:24},"1":{name:"(anonymous_1)",decl:{start:{line:28,column:33},end:{line:28,column:34}},loc:{start:{line:28,column:54},end:{line:52,column:9}},line:28},"2":{name:"(anonymous_2)",decl:{start:{line:37,column:46},end:{line:37,column:47}},loc:{start:{line:38,column:16},end:{line:50,column:18}},line:38},"3":{name:"(anonymous_3)",decl:{start:{line:59,column:17},end:{line:59,column:18}},loc:{start:{line:60,column:4},end:{line:69,column:5}},line:60},"4":{name:"sendPasswordResetEmail",decl:{start:{line:76,column:9},end:{line:76,column:31}},loc:{start:{line:77,column:0},end:{line:112,column:1}},line:77},"5":{name:"(anonymous_5)",decl:{start:{line:82,column:16},end:{line:82,column:17}},loc:{start:{line:83,column:4},end:{line:88,column:5}},line:83},"6":{name:"(anonymous_6)",decl:{start:{line:104,column:48},end:{line:104,column:49}},loc:{start:{line:105,column:4},end:{line:110,column:5}},line:105}},branchMap:{"0":{loc:{start:{line:29,column:12},end:{line:51,column:13}},type:"if",locations:[{start:{line:29,column:12},end:{line:51,column:13}},{start:{line:29,column:12},end:{line:51,column:13}}],line:29},"1":{loc:{start:{line:39,column:20},end:{line:49,column:22}},type:"if",locations:[{start:{line:39,column:20},end:{line:49,column:22}},{start:{line:39,column:20},end:{line:49,column:22}}],line:39},"2":{loc:{start:{line:84,column:8},end:{line:86,column:9}},type:"if",locations:[{start:{line:84,column:8},end:{line:86,column:9}},{start:{line:84,column:8},end:{line:86,column:9}}],line:84},"3":{loc:{start:{line:106,column:8},end:{line:109,column:9}},type:"if",locations:[{start:{line:106,column:8},end:{line:109,column:9}},{start:{line:106,column:8},end:{line:109,column:9}}],line:106}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"6d7460f230343959ea664fb25dbfddffa149c3e3"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_25kmbsnw9z=function(){return actualCoverage;};}return actualCoverage;}cov_25kmbsnw9z();//Created by Jacobus Janse van Rensburg
//
//This file contains the API function declarations and implementations for all functionality of sending emails to users
var nodeMailer=(cov_25kmbsnw9z().s[0]++,require('nodemailer'));const{Doctor,Receptionist,PasswordChanges}=(cov_25kmbsnw9z().s[1]++,require('../model/3DModelModel'));var transporter=(cov_25kmbsnw9z().s[2]++,nodeMailer.createTransport({host:"smtp.mailtrap.io",port:2525,auth:{user:"0c9f2b08034ef4",pass:"c1fd4b36bbc842"}}));cov_25kmbsnw9z().s[3]++;module.exports={//========================================================================================
//function developed by Jacobus Janse van Rensburg
//sends a email to the user to allow the user to change their passwords
passwordChangeEmail:function(req,res){cov_25kmbsnw9z().f[0]++;// need to see if the email is actually in the database
const{email}=(cov_25kmbsnw9z().s[4]++,req.body);cov_25kmbsnw9z().s[5]++;Doctor.findOne({email},function(err,doctor){cov_25kmbsnw9z().f[1]++;cov_25kmbsnw9z().s[6]++;if(doctor){cov_25kmbsnw9z().b[0][0]++;cov_25kmbsnw9z().s[7]++;sendPasswordResetEmail(req);cov_25kmbsnw9z().s[8]++;res.status(200).send("ok");cov_25kmbsnw9z().s[9]++;return;}else{cov_25kmbsnw9z().b[0][1]++;cov_25kmbsnw9z().s[10]++;Receptionist.findOne({email},function(err,receptionist){cov_25kmbsnw9z().f[2]++;cov_25kmbsnw9z().s[11]++;if(receptionist){cov_25kmbsnw9z().b[1][0]++;cov_25kmbsnw9z().s[12]++;sendPasswordResetEmail(req);cov_25kmbsnw9z().s[13]++;res.status(200).send("ok");cov_25kmbsnw9z().s[14]++;return;}else{cov_25kmbsnw9z().b[1][1]++;cov_25kmbsnw9z().s[15]++;res.status(400).send("not ok");cov_25kmbsnw9z().s[16]++;return;}});}});cov_25kmbsnw9z().s[17]++;return;},//===================================================================================
//function developed by Jacobus Janse van Rensburg
signupEmail:function(req,res){cov_25kmbsnw9z().f[3]++;var passwordChangeOptions=(cov_25kmbsnw9z().s[18]++,{from:'flap.jacks.cs@gmail.com',to:req.body.email,subject:'3D Render Password Change',html:'<div style="background-color: #343a40; width: 400px; padding: 10px; border-radius: 10px; position:relative;margin:0 auto; margin-top: 100px;"><h1 style="color:white;text-align: center;">Password Reset</h1><hr><h2 style="color:lightblue;text-align: center;" id="emailLink">USER_EMAIL_HERE</h2><p style="text-align: center; color:white;">You have requested to change your password. <br>Click on the link below to reset your password.</p><div style="text-align:center;"><a style="color:lightblue;" href="RESET_PASSWORD_URL">Reset Password</a></div><hr><p style="text-align: center; color:white; font-size: 13px;">If this was not you, please ignore this email.<br>Your passowrd will remain the same.</p></div>'});}};//======================================================================================================
//function developed by: Jacobus Jane van Rensburg 
//Email HTML developed by rani
//function that sends the actual email to reset the users password
function sendPasswordResetEmail(req){cov_25kmbsnw9z().f[4]++;var email=(cov_25kmbsnw9z().s[19]++,req.body.email);var record=(cov_25kmbsnw9z().s[20]++,new PasswordChanges({email}));var id=(cov_25kmbsnw9z().s[21]++,record._id);//store a temporary record in the database with a id to mach for a valid password change 
cov_25kmbsnw9z().s[22]++;record.save(function(err){cov_25kmbsnw9z().f[5]++;cov_25kmbsnw9z().s[23]++;if(err){cov_25kmbsnw9z().b[2][0]++;cov_25kmbsnw9z().s[24]++;console.log(err);}else{cov_25kmbsnw9z().b[2][1]++;}});//setting the details of the email to be sent
var passwordChangeOptions=(cov_25kmbsnw9z().s[25]++,{from:'flap.jacks.cs@gmail.com',to:req.body.email,subject:'3D Render Password Change',html:'<div style="background-color: #343a40; width: 400px; padding: 10px; border-radius: 10px; position:relative;margin:0 auto; margin-top: 100px;"><h1 style="color:white;text-align: center;">Password Reset</h1><hr><h2 style="color:lightblue;text-align: center;" id="emailLink">USER_EMAIL_HERE</h2><p style="text-align: center; color:white;">You have requested to change your password. <br>Click on the link below to reset your password.</p><div style="text-align:center;"><a style="color:lightblue;" href="RESET_PASSWORD_URL">Reset Password</a></div><hr><p style="text-align: center; color:white; font-size: 13px;">If this was not you, please ignore this email.<br>Your passowrd will remain the same.</p></div>'});//setting the variants in the email that is dependent on certain users
var resetURL=(cov_25kmbsnw9z().s[26]++,"localhost:3000/ResetPassword.html?email="+req.body.email+"&code="+id);cov_25kmbsnw9z().s[27]++;passwordChangeOptions.html=passwordChangeOptions.html.replace('RESET_PASSWORD_URL',resetURL);cov_25kmbsnw9z().s[28]++;passwordChangeOptions.html=passwordChangeOptions.html.replace('USER_EMAIL_HERE',req.body.email);//send the actual email
cov_25kmbsnw9z().s[29]++;transporter.sendMail(passwordChangeOptions,function(error,info){cov_25kmbsnw9z().f[6]++;cov_25kmbsnw9z().s[30]++;if(error){cov_25kmbsnw9z().b[3][0]++;cov_25kmbsnw9z().s[31]++;console.log(error);}else{cov_25kmbsnw9z().b[3][1]++;}});}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkVtYWlsQ29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJub2RlTWFpbGVyIiwicmVxdWlyZSIsIkRvY3RvciIsIlJlY2VwdGlvbmlzdCIsIlBhc3N3b3JkQ2hhbmdlcyIsInRyYW5zcG9ydGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJhdXRoIiwidXNlciIsInBhc3MiLCJtb2R1bGUiLCJleHBvcnRzIiwicGFzc3dvcmRDaGFuZ2VFbWFpbCIsInJlcSIsInJlcyIsImVtYWlsIiwiYm9keSIsImZpbmRPbmUiLCJlcnIiLCJkb2N0b3IiLCJzZW5kUGFzc3dvcmRSZXNldEVtYWlsIiwic3RhdHVzIiwic2VuZCIsInJlY2VwdGlvbmlzdCIsInNpZ251cEVtYWlsIiwicGFzc3dvcmRDaGFuZ2VPcHRpb25zIiwiZnJvbSIsInRvIiwic3ViamVjdCIsImh0bWwiLCJyZWNvcmQiLCJpZCIsIl9pZCIsInNhdmUiLCJjb25zb2xlIiwibG9nIiwicmVzZXRVUkwiLCJyZXBsYWNlIiwic2VuZE1haWwiLCJlcnJvciIsImluZm8iXSwibWFwcGluZ3MiOiJ5akpBZVk7MkZBZlo7QUFDQTtBQUNBO0FBRUEsR0FBSUEsQ0FBQUEsVUFBVSwwQkFBR0MsT0FBTyxDQUFDLFlBQUQsQ0FBVixDQUFkLENBQ0EsS0FBTSxDQUFFQyxNQUFGLENBQVVDLFlBQVYsQ0FBd0JDLGVBQXhCLDJCQUE0Q0gsT0FBTyxDQUFDLHVCQUFELENBQW5ELENBQU4sQ0FHQSxHQUFJSSxDQUFBQSxXQUFXLDBCQUFHTCxVQUFVLENBQUNNLGVBQVgsQ0FBMkIsQ0FDekNDLElBQUksQ0FBQyxrQkFEb0MsQ0FFekNDLElBQUksQ0FBRSxJQUZtQyxDQUd6Q0MsSUFBSSxDQUFDLENBQ0RDLElBQUksQ0FBQyxnQkFESixDQUVEQyxJQUFJLENBQUMsZ0JBRkosQ0FIb0MsQ0FBM0IsQ0FBSCxDQUFmLEMsd0JBU0FDLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixDQUViO0FBQ0E7QUFDQTtBQUNBQyxtQkFB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bUMsUUFBWixDQUFxQmIscUJBQXJCLENBQTRDLFNBQVNjLEtBQVQsQ0FBZ0JDLElBQWhCLENBQzVDLGtEQUNJLEdBQUlELEtBQUosQ0FDQSxxREFDSUwsT0FBTyxDQUFDQyxHQUFSLENBQVlJLEtBQVosRUFDSCxDQUhELGlDQUlILENBTkQsRUFRSCIsInNvdXJjZXNDb250ZW50IjpbIi8vQ3JlYXRlZCBieSBKYWNvYnVzIEphbnNlIHZhbiBSZW5zYnVyZ1xuLy9cbi8vVGhpcyBmaWxlIGNvbnRhaW5zIHRoZSBBUEkgZnVuY3Rpb24gZGVjbGFyYXRpb25zIGFuZCBpbXBsZW1lbnRhdGlvbnMgZm9yIGFsbCBmdW5jdGlvbmFsaXR5IG9mIHNlbmRpbmcgZW1haWxzIHRvIHVzZXJzXG5cbnZhciBub2RlTWFpbGVyID0gcmVxdWlyZSgnbm9kZW1haWxlcicpO1xuY29uc3QgeyBEb2N0b3IsIFJlY2VwdGlvbmlzdCwgUGFzc3dvcmRDaGFuZ2VzIH0gPSByZXF1aXJlKCcuLi9tb2RlbC8zRE1vZGVsTW9kZWwnKTtcblxuXG52YXIgdHJhbnNwb3J0ZXIgPSBub2RlTWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh7XG4gICAgaG9zdDpcInNtdHAubWFpbHRyYXAuaW9cIixcbiAgICBwb3J0OiAyNTI1LFxuICAgIGF1dGg6e1xuICAgICAgICB1c2VyOlwiMGM5ZjJiMDgwMzRlZjRcIixcbiAgICAgICAgcGFzczpcImMxZmQ0YjM2YmJjODQyXCJcbiAgICB9IFxuIH0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIC8vZnVuY3Rpb24gZGV2ZWxvcGVkIGJ5IEphY29idXMgSmFuc2UgdmFuIFJlbnNidXJnXG4gICAgLy9zZW5kcyBhIGVtYWlsIHRvIHRoZSB1c2VyIHRvIGFsbG93IHRoZSB1c2VyIHRvIGNoYW5nZSB0aGVpciBwYXNzd29yZHNcbiAgICBwYXNzd29yZENoYW5nZUVtYWlsOiBmdW5jdGlvbihyZXEgLCByZXMpXG4gICAge1xuICAgICAgICAvLyBuZWVkIHRvIHNlZSBpZiB0aGUgZW1haWwgaXMgYWN0dWFsbHkgaW4gdGhlIGRhdGFiYXNlXG4gICAgICAgIGNvbnN0IHtlbWFpbH0gPSByZXEuYm9keTtcblxuICAgICAgICBEb2N0b3IuZmluZE9uZSh7ZW1haWx9ICwgZnVuY3Rpb24oZXJyLCBkb2N0b3Ipe1xuICAgICAgICAgICAgaWYgKCBkb2N0b3IgKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHNlbmRQYXNzd29yZFJlc2V0RW1haWwocmVxKTtcbiAgICAgICAgICAgICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChcIm9rXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBSZWNlcHRpb25pc3QuZmluZE9uZSh7ZW1haWx9LCBmdW5jdGlvbiAoZXJyLCByZWNlcHRpb25pc3QpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIHJlY2VwdGlvbmlzdCApXG4gICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChyZXEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKFwib2tcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOyBcbiAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgIGVsc2UgXG4gICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoXCJub3Qgb2tcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9LFxuXG5cbiAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgLy9mdW5jdGlvbiBkZXZlbG9wZWQgYnkgSmFjb2J1cyBKYW5zZSB2YW4gUmVuc2J1cmdcbiAgICBzaWdudXBFbWFpbDogZnVuY3Rpb24gKHJlcSAscmVzKVxuICAgIHtcbiAgICAgICAgdmFyIHBhc3N3b3JkQ2hhbmdlT3B0aW9ucyA9IFxuICAgICAgICB7XG4gICAgICAgICAgICBmcm9tOiAnZmxhcC5qYWNrcy5jc0BnbWFpbC5jb20nLFxuICAgICAgICAgICAgdG86cmVxLmJvZHkuZW1haWwsXG4gICAgICAgICAgICBzdWJqZWN0OiAnM0QgUmVuZGVyIFBhc3N3b3JkIENoYW5nZScsXG4gICAgICAgICAgICBodG1sOic8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogIzM0M2E0MDsgd2lkdGg6IDQwMHB4OyBwYWRkaW5nOiAxMHB4OyBib3JkZXItcmFkaXVzOiAxMHB4OyBwb3NpdGlvbjpyZWxhdGl2ZTttYXJnaW46MCBhdXRvOyBtYXJnaW4tdG9wOiAxMDBweDtcIj48aDEgc3R5bGU9XCJjb2xvcjp3aGl0ZTt0ZXh0LWFsaWduOiBjZW50ZXI7XCI+UGFzc3dvcmQgUmVzZXQ8L2gxPjxocj48aDIgc3R5bGU9XCJjb2xvcjpsaWdodGJsdWU7dGV4dC1hbGlnbjogY2VudGVyO1wiIGlkPVwiZW1haWxMaW5rXCI+VVNFUl9FTUFJTF9IRVJFPC9oMj48cCBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgY29sb3I6d2hpdGU7XCI+WW91IGhhdmUgcmVxdWVzdGVkIHRvIGNoYW5nZSB5b3VyIHBhc3N3b3JkLiA8YnI+Q2xpY2sgb24gdGhlIGxpbmsgYmVsb3cgdG8gcmVzZXQgeW91ciBwYXNzd29yZC48L3A+PGRpdiBzdHlsZT1cInRleHQtYWxpZ246Y2VudGVyO1wiPjxhIHN0eWxlPVwiY29sb3I6bGlnaHRibHVlO1wiIGhyZWY9XCJSRVNFVF9QQVNTV09SRF9VUkxcIj5SZXNldCBQYXNzd29yZDwvYT48L2Rpdj48aHI+PHAgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IGNvbG9yOndoaXRlOyBmb250LXNpemU6IDEzcHg7XCI+SWYgdGhpcyB3YXMgbm90IHlvdSwgcGxlYXNlIGlnbm9yZSB0aGlzIGVtYWlsLjxicj5Zb3VyIHBhc3Nvd3JkIHdpbGwgcmVtYWluIHRoZSBzYW1lLjwvcD48L2Rpdj4nXG4gICAgICAgIH07XG5cbiAgICB9XG59XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vL2Z1bmN0aW9uIGRldmVsb3BlZCBieTogSmFjb2J1cyBKYW5lIHZhbiBSZW5zYnVyZyBcbi8vRW1haWwgSFRNTCBkZXZlbG9wZWQgYnkgcmFuaVxuLy9mdW5jdGlvbiB0aGF0IHNlbmRzIHRoZSBhY3R1YWwgZW1haWwgdG8gcmVzZXQgdGhlIHVzZXJzIHBhc3N3b3JkXG5mdW5jdGlvbiBzZW5kUGFzc3dvcmRSZXNldEVtYWlsKHJlcSlcbntcbiAgICB2YXIgZW1haWwgPSByZXEuYm9keS5lbWFpbDtcbiAgICB2YXIgcmVjb3JkID0gbmV3IFBhc3N3b3JkQ2hhbmdlcyh7ZW1haWx9KTtcbiAgICB2YXIgaWQgPSByZWNvcmQuX2lkO1xuICAgIC8vc3RvcmUgYSB0ZW1wb3JhcnkgcmVjb3JkIGluIHRoZSBkYXRhYmFzZSB3aXRoIGEgaWQgdG8gbWFjaCBmb3IgYSB2YWxpZCBwYXNzd29yZCBjaGFuZ2UgXG4gICAgcmVjb3JkLnNhdmUoZnVuY3Rpb24gKGVycilcbiAgICB7XG4gICAgICAgIGlmIChlcnIpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9KTtcblxuICAgIC8vc2V0dGluZyB0aGUgZGV0YWlscyBvZiB0aGUgZW1haWwgdG8gYmUgc2VudFxuICAgIHZhciBwYXNzd29yZENoYW5nZU9wdGlvbnMgPSBcbiAgICB7XG4gICAgICAgIGZyb206ICdmbGFwLmphY2tzLmNzQGdtYWlsLmNvbScsXG4gICAgICAgIHRvOnJlcS5ib2R5LmVtYWlsLFxuICAgICAgICBzdWJqZWN0OiAnM0QgUmVuZGVyIFBhc3N3b3JkIENoYW5nZScsXG4gICAgICAgIGh0bWw6JzxkaXYgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiAjMzQzYTQwOyB3aWR0aDogNDAwcHg7IHBhZGRpbmc6IDEwcHg7IGJvcmRlci1yYWRpdXM6IDEwcHg7IHBvc2l0aW9uOnJlbGF0aXZlO21hcmdpbjowIGF1dG87IG1hcmdpbi10b3A6IDEwMHB4O1wiPjxoMSBzdHlsZT1cImNvbG9yOndoaXRlO3RleHQtYWxpZ246IGNlbnRlcjtcIj5QYXNzd29yZCBSZXNldDwvaDE+PGhyPjxoMiBzdHlsZT1cImNvbG9yOmxpZ2h0Ymx1ZTt0ZXh0LWFsaWduOiBjZW50ZXI7XCIgaWQ9XCJlbWFpbExpbmtcIj5VU0VSX0VNQUlMX0hFUkU8L2gyPjxwIHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBjb2xvcjp3aGl0ZTtcIj5Zb3UgaGF2ZSByZXF1ZXN0ZWQgdG8gY2hhbmdlIHlvdXIgcGFzc3dvcmQuIDxicj5DbGljayBvbiB0aGUgbGluayBiZWxvdyB0byByZXNldCB5b3VyIHBhc3N3b3JkLjwvcD48ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjpjZW50ZXI7XCI+PGEgc3R5bGU9XCJjb2xvcjpsaWdodGJsdWU7XCIgaHJlZj1cIlJFU0VUX1BBU1NXT1JEX1VSTFwiPlJlc2V0IFBhc3N3b3JkPC9hPjwvZGl2Pjxocj48cCBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgY29sb3I6d2hpdGU7IGZvbnQtc2l6ZTogMTNweDtcIj5JZiB0aGlzIHdhcyBub3QgeW91LCBwbGVhc2UgaWdub3JlIHRoaXMgZW1haWwuPGJyPllvdXIgcGFzc293cmQgd2lsbCByZW1haW4gdGhlIHNhbWUuPC9wPjwvZGl2PidcbiAgICB9O1xuXG4gICAgLy9zZXR0aW5nIHRoZSB2YXJpYW50cyBpbiB0aGUgZW1haWwgdGhhdCBpcyBkZXBlbmRlbnQgb24gY2VydGFpbiB1c2Vyc1xuICAgIHZhciByZXNldFVSTD1cImxvY2FsaG9zdDozMDAwL1Jlc2V0UGFzc3dvcmQuaHRtbD9lbWFpbD1cIityZXEuYm9keS5lbWFpbCtcIiZjb2RlPVwiK2lkO1xuICAgIHBhc3N3b3JkQ2hhbmdlT3B0aW9ucy5odG1sID0gcGFzc3dvcmRDaGFuZ2VPcHRpb25zLmh0bWwucmVwbGFjZSgnUkVTRVRfUEFTU1dPUkRfVVJMJyxyZXNldFVSTCk7XG4gICAgcGFzc3dvcmRDaGFuZ2VPcHRpb25zLmh0bWwgPSBwYXNzd29yZENoYW5nZU9wdGlvbnMuaHRtbC5yZXBsYWNlKCdVU0VSX0VNQUlMX0hFUkUnLHJlcS5ib2R5LmVtYWlsKTtcbiAgICAvL3NlbmQgdGhlIGFjdHVhbCBlbWFpbFxuICAgIHRyYW5zcG9ydGVyLnNlbmRNYWlsKHBhc3N3b3JkQ2hhbmdlT3B0aW9ucywgZnVuY3Rpb24oZXJyb3IsIGluZm8pXG4gICAge1xuICAgICAgICBpZiAoZXJyb3IpIFxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH0gXG4gICAgfSk7XG5cbn1cbiJdfQ==