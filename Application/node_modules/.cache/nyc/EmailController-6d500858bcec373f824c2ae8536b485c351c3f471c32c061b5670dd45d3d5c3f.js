function cov_2a7zmutge9(){var path="/home/marcus/UNI/Year 3/COS 301/Capstone/Feature-Improvements/3D-model-Binary-Vision/Application/api/controller/EmailController.js";var hash="c4edb42af90405d5bf73c15f0c94411cf4f53e24";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/marcus/UNI/Year 3/COS 301/Capstone/Feature-Improvements/3D-model-Binary-Vision/Application/api/controller/EmailController.js",statementMap:{"0":{start:{line:5,column:17},end:{line:5,column:38}},"1":{start:{line:6,column:50},end:{line:6,column:82}},"2":{start:{line:9,column:18},end:{line:16,column:3}},"3":{start:{line:18,column:0},end:{line:69,column:1}},"4":{start:{line:26,column:24},end:{line:26,column:32}},"5":{start:{line:28,column:8},end:{line:28,column:30}},"6":{start:{line:30,column:8},end:{line:53,column:11}},"7":{start:{line:31,column:12},end:{line:52,column:13}},"8":{start:{line:33,column:16},end:{line:33,column:38}},"9":{start:{line:34,column:16},end:{line:34,column:44}},"10":{start:{line:35,column:16},end:{line:35,column:51}},"11":{start:{line:36,column:16},end:{line:36,column:23}},"12":{start:{line:39,column:16},end:{line:51,column:20}},"13":{start:{line:40,column:20},end:{line:50,column:22}},"14":{start:{line:42,column:24},end:{line:42,column:46}},"15":{start:{line:43,column:25},end:{line:43,column:53}},"16":{start:{line:44,column:25},end:{line:44,column:60}},"17":{start:{line:45,column:25},end:{line:45,column:32}},"18":{start:{line:48,column:25},end:{line:48,column:64}},"19":{start:{line:49,column:25},end:{line:49,column:32}},"20":{start:{line:54,column:8},end:{line:54,column:15}},"21":{start:{line:61,column:36},end:{line:66,column:9}},"22":{start:{line:76,column:16},end:{line:76,column:30}},"23":{start:{line:77,column:17},end:{line:77,column:45}},"24":{start:{line:78,column:13},end:{line:78,column:23}},"25":{start:{line:80,column:4},end:{line:85,column:7}},"26":{start:{line:81,column:8},end:{line:83,column:9}},"27":{start:{line:82,column:12},end:{line:82,column:29}},"28":{start:{line:88,column:32},end:{line:93,column:5}},"29":{start:{line:96,column:17},end:{line:96,column:86}},"30":{start:{line:97,column:4},end:{line:97,column:99}},"31":{start:{line:98,column:4},end:{line:98,column:102}},"32":{start:{line:100,column:4},end:{line:105,column:7}},"33":{start:{line:101,column:8},end:{line:104,column:9}},"34":{start:{line:103,column:12},end:{line:103,column:31}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:23,column:25},end:{line:23,column:26}},loc:{start:{line:24,column:4},end:{line:55,column:5}},line:24},"1":{name:"(anonymous_1)",decl:{start:{line:30,column:33},end:{line:30,column:34}},loc:{start:{line:30,column:54},end:{line:53,column:9}},line:30},"2":{name:"(anonymous_2)",decl:{start:{line:39,column:46},end:{line:39,column:47}},loc:{start:{line:39,column:74},end:{line:51,column:18}},line:39},"3":{name:"(anonymous_3)",decl:{start:{line:60,column:17},end:{line:60,column:18}},loc:{start:{line:60,column:36},end:{line:68,column:5}},line:60},"4":{name:"sendPasswordResetEmail",decl:{start:{line:75,column:9},end:{line:75,column:31}},loc:{start:{line:75,column:36},end:{line:107,column:1}},line:75},"5":{name:"(anonymous_5)",decl:{start:{line:80,column:16},end:{line:80,column:17}},loc:{start:{line:80,column:30},end:{line:85,column:5}},line:80},"6":{name:"(anonymous_6)",decl:{start:{line:100,column:48},end:{line:100,column:49}},loc:{start:{line:100,column:69},end:{line:105,column:5}},line:100}},branchMap:{"0":{loc:{start:{line:31,column:12},end:{line:52,column:13}},type:"if",locations:[{start:{line:31,column:12},end:{line:52,column:13}},{start:{line:31,column:12},end:{line:52,column:13}}],line:31},"1":{loc:{start:{line:40,column:20},end:{line:50,column:22}},type:"if",locations:[{start:{line:40,column:20},end:{line:50,column:22}},{start:{line:40,column:20},end:{line:50,column:22}}],line:40},"2":{loc:{start:{line:81,column:8},end:{line:83,column:9}},type:"if",locations:[{start:{line:81,column:8},end:{line:83,column:9}},{start:{line:81,column:8},end:{line:83,column:9}}],line:81},"3":{loc:{start:{line:101,column:8},end:{line:104,column:9}},type:"if",locations:[{start:{line:101,column:8},end:{line:104,column:9}},{start:{line:101,column:8},end:{line:104,column:9}}],line:101}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c4edb42af90405d5bf73c15f0c94411cf4f53e24"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2a7zmutge9=function(){return actualCoverage;};}return actualCoverage;}cov_2a7zmutge9();//Created by Jacobus Janse van Rensburg
//
//This file contains the API function declarations and implementations for all functionality of sending emails to users
var nodeMailer=(cov_2a7zmutge9().s[0]++,require('nodemailer'));const{Doctor,Receptionist,PasswordChanges}=(cov_2a7zmutge9().s[1]++,require('../model/3DModelModel'));var transporter=(cov_2a7zmutge9().s[2]++,nodeMailer.createTransport({host:"smtp.mailtrap.io",port:2525,auth:{user:"0c9f2b08034ef4",pass:"c1fd4b36bbc842"}}));cov_2a7zmutge9().s[3]++;module.exports={//========================================================================================
//function developed by Jacobus Janse van Rensburg
//sends a email to the user to allow the user to change their passwords
passwordChangeEmail:function(req,res){cov_2a7zmutge9().f[0]++;// need to see if the email is actually in the database
const{email}=(cov_2a7zmutge9().s[4]++,req.body);cov_2a7zmutge9().s[5]++;console.log("here 1");cov_2a7zmutge9().s[6]++;Doctor.findOne({email},function(err,doctor){cov_2a7zmutge9().f[1]++;cov_2a7zmutge9().s[7]++;if(doctor){cov_2a7zmutge9().b[0][0]++;cov_2a7zmutge9().s[8]++;console.log("here 2");cov_2a7zmutge9().s[9]++;sendPasswordResetEmail(req);cov_2a7zmutge9().s[10]++;res.sendStatus(200)/*.send("ok")*/;cov_2a7zmutge9().s[11]++;return;}else{cov_2a7zmutge9().b[0][1]++;cov_2a7zmutge9().s[12]++;Receptionist.findOne({email},function(err,receptionist){cov_2a7zmutge9().f[2]++;cov_2a7zmutge9().s[13]++;if(receptionist){cov_2a7zmutge9().b[1][0]++;cov_2a7zmutge9().s[14]++;console.log("here 3");cov_2a7zmutge9().s[15]++;sendPasswordResetEmail(req);cov_2a7zmutge9().s[16]++;res.sendStatus(200)/*.send("ok")*/;cov_2a7zmutge9().s[17]++;return;}else{cov_2a7zmutge9().b[1][1]++;cov_2a7zmutge9().s[18]++;res.sendStatus(400)/*.send("not ok")*/;cov_2a7zmutge9().s[19]++;return;}});}});cov_2a7zmutge9().s[20]++;return;},//===================================================================================
//function developed by Jacobus Janse van Rensburg
signupEmail:function(req,res){cov_2a7zmutge9().f[3]++;var passwordChangeOptions=(cov_2a7zmutge9().s[21]++,{from:'flap.jacks.cs@gmail.com',to:req.body.email,subject:'3D Render Password Change',html:'<div style="background-color: #343a40; width: 400px; padding: 10px; border-radius: 10px; position:relative;margin:0 auto; margin-top: 100px;"><h1 style="color:white;text-align: center;">Password Reset</h1><hr><h2 style="color:lightblue;text-align: center;" id="emailLink">USER_EMAIL_HERE</h2><p style="text-align: center; color:white;">You have requested to change your password. <br>Click on the link below to reset your password.</p><div style="text-align:center;"><a style="color:lightblue;" href="RESET_PASSWORD_URL">Reset Password</a></div><hr><p style="text-align: center; color:white; font-size: 13px;">If this was not you, please ignore this email.<br>Your passowrd will remain the same.</p></div>'});}};//======================================================================================================
//function developed by: Jacobus Jane van Rensburg 
//Email HTML developed by rani
//function that sends the actual email to reset the users password
function sendPasswordResetEmail(req){cov_2a7zmutge9().f[4]++;var email=(cov_2a7zmutge9().s[22]++,req.body.email);var record=(cov_2a7zmutge9().s[23]++,new PasswordChanges({email}));var id=(cov_2a7zmutge9().s[24]++,record._id);//store a temporary record in the database with a id to mach for a valid password change 
cov_2a7zmutge9().s[25]++;record.save(function(err){cov_2a7zmutge9().f[5]++;cov_2a7zmutge9().s[26]++;if(err){cov_2a7zmutge9().b[2][0]++;cov_2a7zmutge9().s[27]++;console.log(err);}else{cov_2a7zmutge9().b[2][1]++;}});//setting the details of the email to be sent
var passwordChangeOptions=(cov_2a7zmutge9().s[28]++,{from:'flap.jacks.cs@gmail.com',to:req.body.email,subject:'3D Render Password Change',html:'<div style="background-color: #343a40; width: 400px; padding: 10px; border-radius: 10px; position:relative;margin:0 auto; margin-top: 100px;"><h1 style="color:white;text-align: center;">Password Reset</h1><hr><h2 style="color:lightblue;text-align: center;" id="emailLink">USER_EMAIL_HERE</h2><p style="text-align: center; color:white;">You have requested to change your password. <br>Click on the link below to reset your password.</p><div style="text-align:center;"><a style="color:lightblue;" href="RESET_PASSWORD_URL">Reset Password</a></div><hr><p style="text-align: center; color:white; font-size: 13px;">If this was not you, please ignore this email.<br>Your passowrd will remain the same.</p></div>'});//setting the variants in the email that is dependent on certain users
var resetURL=(cov_2a7zmutge9().s[29]++,"localhost:3000/ResetPassword.html?email="+req.body.email+"&code="+id);cov_2a7zmutge9().s[30]++;passwordChangeOptions.html=passwordChangeOptions.html.replace('RESET_PASSWORD_URL',resetURL);cov_2a7zmutge9().s[31]++;passwordChangeOptions.html=passwordChangeOptions.html.replace('USER_EMAIL_HERE',req.body.email);//send the actual email
cov_2a7zmutge9().s[32]++;transporter.sendMail(passwordChangeOptions,function(error,info){cov_2a7zmutge9().f[6]++;cov_2a7zmutge9().s[33]++;if(error){cov_2a7zmutge9().b[3][0]++;cov_2a7zmutge9().s[34]++;console.log(error);}else{cov_2a7zmutge9().b[3][1]++;}});}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkVtYWlsQ29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJub2RlTWFpbGVyIiwicmVxdWlyZSIsIkRvY3RvciIsIlJlY2VwdGlvbmlzdCIsIlBhc3N3b3JkQ2hhbmdlcyIsInRyYW5zcG9ydGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJhdXRoIiwidXNlciIsInBhc3MiLCJtb2R1bGUiLCJleHBvcnRzIiwicGFzc3dvcmRDaGFuZ2VFbWFpbCIsInJlcSIsInJlcyIsImVtYWlsIiwiYm9keSIsImNvbnNvbGUiLCJsb2ciLCJmaW5kT25lIiwiZXJyIiwiZG9jdG9yIiwic2VuZFBhc3N3b3JkUmVzZXRFbWFpbCIsInNlbmRTdGF0dXMiLCJyZWNlcHRpb25pc3QiLCJzaWdudXBFbWFpbCIsInBhc3N3b3JkQ2hhbmdlT3B0aW9ucyIsImZyb20iLCJ0byIsInN1YmplY3QiLCJodG1sIiwicmVjb3JkIiwiaWQiLCJfaWQiLCJzYXZlIiwicmVzZXRVUkwiLCJyZXBsYWNlIiwic2VuZE1haWwiLCJlcnJvciIsImluZm8iXSwibWFwcGluZ3MiOiIwdkpBZVk7MkZBZlo7QUFDQTtBQUNBO0FBRUEsR0FBSUEsQ0FBQUEsVUFBVSwwQkFBR0MsT0FBTyxDQUFDLFlBQUQsQ0FBVixDQUFkLENBQ0EsS0FBTSxDQUFFQyxNQUFGLENBQVVDLFlBQVYsQ0FBd0JDLGVBQXhCLDJCQUE0Q0gsT0FBTyxDQUFDLHVCQUFELENBQW5ELENBQU4sQ0FHQSxHQUFJSSxDQUFBQSxXQUFXLDBCQUFHTCxVQUFVLENBQUNNLGVBQVgsQ0FBMkIsQ0FDekNDLElBQUksQ0FBQyxrQkFEb0MsQ0FFekNDLElBQUksQ0FBRSxJQUZtQyxDQUd6Q0MsSUFBSSxDQUFDLENBQ0RDLElBQUksQ0FBQyxnQkFESixDQUVEQyxJQUFJLENBQUMsZ0JBRkosQ0FIb0MsQ0FBM0IsQ0FBSCxDQUFmLEMsd0JBU0FDLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixDQUViO0FBQ0E7QUFDQTtBQUNBQyxtQkFBbUIs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LE9BQTNCLENBQW1DLGlCQUFuQyxDQUFxRHZCLEdBQUcsQ0FBQ0csSUFBSixDQUFTRCxLQUE5RCxDQUE3QixDQUNBO0FBeEJnQyx5QkF5QmhDWixXQUFXLENBQUNrQyxRQUFaLENBQXFCWCxxQkFBckIsQ0FBNEMsU0FBU1ksS0FBVCxDQUFnQkMsSUFBaEIsQ0FBcUIsa0RBQzdELEdBQUlELEtBQUosQ0FDQSxxREFDSXJCLE9BQU8sQ0FBQ0MsR0FBUixDQUFZb0IsS0FBWixFQUNILENBSEQsaUNBSUgsQ0FMRCxFQU9IIiwic291cmNlc0NvbnRlbnQiOlsiLy9DcmVhdGVkIGJ5IEphY29idXMgSmFuc2UgdmFuIFJlbnNidXJnXG4vL1xuLy9UaGlzIGZpbGUgY29udGFpbnMgdGhlIEFQSSBmdW5jdGlvbiBkZWNsYXJhdGlvbnMgYW5kIGltcGxlbWVudGF0aW9ucyBmb3IgYWxsIGZ1bmN0aW9uYWxpdHkgb2Ygc2VuZGluZyBlbWFpbHMgdG8gdXNlcnNcblxudmFyIG5vZGVNYWlsZXIgPSByZXF1aXJlKCdub2RlbWFpbGVyJyk7XG5jb25zdCB7IERvY3RvciwgUmVjZXB0aW9uaXN0LCBQYXNzd29yZENoYW5nZXMgfSA9IHJlcXVpcmUoJy4uL21vZGVsLzNETW9kZWxNb2RlbCcpO1xuXG5cbnZhciB0cmFuc3BvcnRlciA9IG5vZGVNYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICBob3N0Olwic210cC5tYWlsdHJhcC5pb1wiLFxuICAgIHBvcnQ6IDI1MjUsXG4gICAgYXV0aDp7XG4gICAgICAgIHVzZXI6XCIwYzlmMmIwODAzNGVmNFwiLFxuICAgICAgICBwYXNzOlwiYzFmZDRiMzZiYmM4NDJcIlxuICAgIH0gXG4gfSk7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXG4gICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgLy9mdW5jdGlvbiBkZXZlbG9wZWQgYnkgSmFjb2J1cyBKYW5zZSB2YW4gUmVuc2J1cmdcbiAgICAvL3NlbmRzIGEgZW1haWwgdG8gdGhlIHVzZXIgdG8gYWxsb3cgdGhlIHVzZXIgdG8gY2hhbmdlIHRoZWlyIHBhc3N3b3Jkc1xuICAgIHBhc3N3b3JkQ2hhbmdlRW1haWw6IGZ1bmN0aW9uKHJlcSAsIHJlcylcbiAgICB7XG4gICAgICAgIC8vIG5lZWQgdG8gc2VlIGlmIHRoZSBlbWFpbCBpcyBhY3R1YWxseSBpbiB0aGUgZGF0YWJhc2VcbiAgICAgICAgY29uc3Qge2VtYWlsfSA9IHJlcS5ib2R5O1xuXG4gICAgICAgIGNvbnNvbGUubG9nKFwiaGVyZSAxXCIpO1xuXG4gICAgICAgIERvY3Rvci5maW5kT25lKHtlbWFpbH0gLCBmdW5jdGlvbihlcnIsIGRvY3Rvcil7XG4gICAgICAgICAgICBpZiAoIGRvY3RvciApXG4gICAgICAgICAgICB7ICAgXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJoZXJlIDJcIik7XG4gICAgICAgICAgICAgICAgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChyZXEpO1xuICAgICAgICAgICAgICAgIHJlcy5zZW5kU3RhdHVzKDIwMCkvKi5zZW5kKFwib2tcIikqLztcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIFJlY2VwdGlvbmlzdC5maW5kT25lKHtlbWFpbH0sIGZ1bmN0aW9uIChlcnIsIHJlY2VwdGlvbmlzdCl7XG4gICAgICAgICAgICAgICAgICAgIGlmICggcmVjZXB0aW9uaXN0IClcbiAgICAgICAgICAgICAgICAgICAgIHsgIFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJoZXJlIDNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChyZXEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zZW5kU3RhdHVzKDIwMCkvKi5zZW5kKFwib2tcIikqLztcbiAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47IFxuICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnNlbmRTdGF0dXMoNDAwKS8qLnNlbmQoXCJub3Qgb2tcIikqLztcbiAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH0sXG5cblxuICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAvL2Z1bmN0aW9uIGRldmVsb3BlZCBieSBKYWNvYnVzIEphbnNlIHZhbiBSZW5zYnVyZ1xuICAgIHNpZ251cEVtYWlsOiBmdW5jdGlvbiAocmVxICxyZXMpe1xuICAgICAgICB2YXIgcGFzc3dvcmRDaGFuZ2VPcHRpb25zID0ge1xuICAgICAgICAgICAgZnJvbTogJ2ZsYXAuamFja3MuY3NAZ21haWwuY29tJyxcbiAgICAgICAgICAgIHRvOnJlcS5ib2R5LmVtYWlsLFxuICAgICAgICAgICAgc3ViamVjdDogJzNEIFJlbmRlciBQYXNzd29yZCBDaGFuZ2UnLFxuICAgICAgICAgICAgaHRtbDonPGRpdiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6ICMzNDNhNDA7IHdpZHRoOiA0MDBweDsgcGFkZGluZzogMTBweDsgYm9yZGVyLXJhZGl1czogMTBweDsgcG9zaXRpb246cmVsYXRpdmU7bWFyZ2luOjAgYXV0bzsgbWFyZ2luLXRvcDogMTAwcHg7XCI+PGgxIHN0eWxlPVwiY29sb3I6d2hpdGU7dGV4dC1hbGlnbjogY2VudGVyO1wiPlBhc3N3b3JkIFJlc2V0PC9oMT48aHI+PGgyIHN0eWxlPVwiY29sb3I6bGlnaHRibHVlO3RleHQtYWxpZ246IGNlbnRlcjtcIiBpZD1cImVtYWlsTGlua1wiPlVTRVJfRU1BSUxfSEVSRTwvaDI+PHAgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IGNvbG9yOndoaXRlO1wiPllvdSBoYXZlIHJlcXVlc3RlZCB0byBjaGFuZ2UgeW91ciBwYXNzd29yZC4gPGJyPkNsaWNrIG9uIHRoZSBsaW5rIGJlbG93IHRvIHJlc2V0IHlvdXIgcGFzc3dvcmQuPC9wPjxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOmNlbnRlcjtcIj48YSBzdHlsZT1cImNvbG9yOmxpZ2h0Ymx1ZTtcIiBocmVmPVwiUkVTRVRfUEFTU1dPUkRfVVJMXCI+UmVzZXQgUGFzc3dvcmQ8L2E+PC9kaXY+PGhyPjxwIHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBjb2xvcjp3aGl0ZTsgZm9udC1zaXplOiAxM3B4O1wiPklmIHRoaXMgd2FzIG5vdCB5b3UsIHBsZWFzZSBpZ25vcmUgdGhpcyBlbWFpbC48YnI+WW91ciBwYXNzb3dyZCB3aWxsIHJlbWFpbiB0aGUgc2FtZS48L3A+PC9kaXY+J1xuICAgICAgICB9O1xuXG4gICAgfVxufVxuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy9mdW5jdGlvbiBkZXZlbG9wZWQgYnk6IEphY29idXMgSmFuZSB2YW4gUmVuc2J1cmcgXG4vL0VtYWlsIEhUTUwgZGV2ZWxvcGVkIGJ5IHJhbmlcbi8vZnVuY3Rpb24gdGhhdCBzZW5kcyB0aGUgYWN0dWFsIGVtYWlsIHRvIHJlc2V0IHRoZSB1c2VycyBwYXNzd29yZFxuZnVuY3Rpb24gc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChyZXEpe1xuICAgIHZhciBlbWFpbCA9IHJlcS5ib2R5LmVtYWlsO1xuICAgIHZhciByZWNvcmQgPSBuZXcgUGFzc3dvcmRDaGFuZ2VzKHtlbWFpbH0pO1xuICAgIHZhciBpZCA9IHJlY29yZC5faWQ7XG4gICAgLy9zdG9yZSBhIHRlbXBvcmFyeSByZWNvcmQgaW4gdGhlIGRhdGFiYXNlIHdpdGggYSBpZCB0byBtYWNoIGZvciBhIHZhbGlkIHBhc3N3b3JkIGNoYW5nZSBcbiAgICByZWNvcmQuc2F2ZShmdW5jdGlvbiAoZXJyKXtcbiAgICAgICAgaWYgKGVycil7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgIH0pO1xuXG4gICAgLy9zZXR0aW5nIHRoZSBkZXRhaWxzIG9mIHRoZSBlbWFpbCB0byBiZSBzZW50XG4gICAgdmFyIHBhc3N3b3JkQ2hhbmdlT3B0aW9ucyA9IHtcbiAgICAgICAgZnJvbTogJ2ZsYXAuamFja3MuY3NAZ21haWwuY29tJyxcbiAgICAgICAgdG86cmVxLmJvZHkuZW1haWwsXG4gICAgICAgIHN1YmplY3Q6ICczRCBSZW5kZXIgUGFzc3dvcmQgQ2hhbmdlJyxcbiAgICAgICAgaHRtbDonPGRpdiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6ICMzNDNhNDA7IHdpZHRoOiA0MDBweDsgcGFkZGluZzogMTBweDsgYm9yZGVyLXJhZGl1czogMTBweDsgcG9zaXRpb246cmVsYXRpdmU7bWFyZ2luOjAgYXV0bzsgbWFyZ2luLXRvcDogMTAwcHg7XCI+PGgxIHN0eWxlPVwiY29sb3I6d2hpdGU7dGV4dC1hbGlnbjogY2VudGVyO1wiPlBhc3N3b3JkIFJlc2V0PC9oMT48aHI+PGgyIHN0eWxlPVwiY29sb3I6bGlnaHRibHVlO3RleHQtYWxpZ246IGNlbnRlcjtcIiBpZD1cImVtYWlsTGlua1wiPlVTRVJfRU1BSUxfSEVSRTwvaDI+PHAgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IGNvbG9yOndoaXRlO1wiPllvdSBoYXZlIHJlcXVlc3RlZCB0byBjaGFuZ2UgeW91ciBwYXNzd29yZC4gPGJyPkNsaWNrIG9uIHRoZSBsaW5rIGJlbG93IHRvIHJlc2V0IHlvdXIgcGFzc3dvcmQuPC9wPjxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOmNlbnRlcjtcIj48YSBzdHlsZT1cImNvbG9yOmxpZ2h0Ymx1ZTtcIiBocmVmPVwiUkVTRVRfUEFTU1dPUkRfVVJMXCI+UmVzZXQgUGFzc3dvcmQ8L2E+PC9kaXY+PGhyPjxwIHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBjb2xvcjp3aGl0ZTsgZm9udC1zaXplOiAxM3B4O1wiPklmIHRoaXMgd2FzIG5vdCB5b3UsIHBsZWFzZSBpZ25vcmUgdGhpcyBlbWFpbC48YnI+WW91ciBwYXNzb3dyZCB3aWxsIHJlbWFpbiB0aGUgc2FtZS48L3A+PC9kaXY+J1xuICAgIH07XG5cbiAgICAvL3NldHRpbmcgdGhlIHZhcmlhbnRzIGluIHRoZSBlbWFpbCB0aGF0IGlzIGRlcGVuZGVudCBvbiBjZXJ0YWluIHVzZXJzXG4gICAgdmFyIHJlc2V0VVJMPVwibG9jYWxob3N0OjMwMDAvUmVzZXRQYXNzd29yZC5odG1sP2VtYWlsPVwiK3JlcS5ib2R5LmVtYWlsK1wiJmNvZGU9XCIraWQ7XG4gICAgcGFzc3dvcmRDaGFuZ2VPcHRpb25zLmh0bWwgPSBwYXNzd29yZENoYW5nZU9wdGlvbnMuaHRtbC5yZXBsYWNlKCdSRVNFVF9QQVNTV09SRF9VUkwnLHJlc2V0VVJMKTtcbiAgICBwYXNzd29yZENoYW5nZU9wdGlvbnMuaHRtbCA9IHBhc3N3b3JkQ2hhbmdlT3B0aW9ucy5odG1sLnJlcGxhY2UoJ1VTRVJfRU1BSUxfSEVSRScscmVxLmJvZHkuZW1haWwpO1xuICAgIC8vc2VuZCB0aGUgYWN0dWFsIGVtYWlsXG4gICAgdHJhbnNwb3J0ZXIuc2VuZE1haWwocGFzc3dvcmRDaGFuZ2VPcHRpb25zLCBmdW5jdGlvbihlcnJvciwgaW5mbyl7XG4gICAgICAgIGlmIChlcnJvcikgXG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgfSBcbiAgICB9KTtcblxufVxuIl19